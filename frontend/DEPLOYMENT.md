# Deploying the React Frontend

This document provides instructions for building and deploying the React frontend application.

## Prerequisites

Before you begin, ensure you have the following installed:

*   **Node.js**: Download and install from [nodejs.org](https://nodejs.org/). This will also install `npm`.
*   **npm** (Node Package Manager) or **yarn**: npm is included with Node.js. You can install yarn from [yarnpkg.com](https://yarnpkg.com/) if you prefer.

## Building the Application

To create a production-ready build of the frontend:

1.  **Navigate to the frontend directory:**
    ```bash
    cd path/to/your-project/frontend
    ```

2.  **Install dependencies:**
    If you're using npm:
    ```bash
    npm install
    ```
    Or, if you're using yarn:
    ```bash
    yarn install
    ```

3.  **Run the build script:**
    If you're using npm:
    ```bash
    npm run build
    ```
    Or, if you're using yarn:
    ```bash
    yarn build
    ```

4.  **Output:**
    The build process will create a `build` directory inside the `frontend` directory (i.e., `frontend/build`). This directory contains the static assets for your application.

## Deployment Options

You can deploy the `frontend/build` directory using various methods:

### 1. Serving with a Static Server

This is a common way to serve React applications, especially when the backend API is on a different server or managed separately.

*   **Using `serve` (Node.js package):**
    1.  Install `serve` globally (if you haven't already):
        ```bash
        npm install -g serve
        ```
    2.  Navigate into the `frontend` directory and serve the `build` folder:
        ```bash
        cd path/to/your-project/frontend
        serve -s build -l 3000 
        ```
        This will serve your application on `http://localhost:3000`. The `-s` flag ensures that all requests are routed to `index.html`, which is necessary for client-side routing in single-page applications (SPAs).

*   **Using Nginx:**
    Nginx is a robust web server suitable for production environments.
    A basic Nginx configuration to serve the React app and handle client-side routing might look like this:
    ```nginx
    server {
        listen 80;
        server_name yourdomain.com; # Replace with your domain

        root /path/to/your-project/frontend/build; # Path to your build directory
        index index.html index.htm;

        location / {
            try_files $uri $uri/ /index.html; # Handles client-side routing
        }

        # Optional: Add other configurations like SSL, gzip, etc.
    }
    ```
    You would place this configuration in your Nginx sites-available directory and create a symlink in sites-enabled.

### 2. Integrating with the Python Backend (FastAPI)

For a more integrated deployment, the FastAPI backend can be configured to serve the static files generated by the React build. This is convenient for smaller applications or when you want a single deployment unit.

*   **Steps:**
    1.  Ensure your React application is built (i.e., `frontend/build` directory exists).
    2.  In your FastAPI application (`app/main.py` or similar):
        *   Import `StaticFiles` and `FileResponse`.
        *   Mount the `StaticFiles` directory.
        *   Add a catch-all route to serve `index.html` for any paths not handled by API routes or static files, enabling client-side routing.

*   **Conceptual FastAPI Example (`app/main.py`):**
    ```python
    from fastapi import FastAPI, HTTPException
    from fastapi.staticfiles import StaticFiles
    from fastapi.responses import FileResponse
    import os

    # ... (your existing FastAPI app setup and routers) ...
    app = FastAPI()

    # Path to the build directory of the React app
    # Adjust this path based on your project structure
    BUILD_DIR = os.path.join(os.path.dirname(os.path.dirname(__file__)), "frontend", "build") # Assumes backend 'app' folder is sibling to 'frontend'

    # Mount static files (CSS, JS, images from React build)
    # This should come *before* the catch-all route for index.html
    app.mount(
        "/static", 
        StaticFiles(directory=os.path.join(BUILD_DIR, "static")), 
        name="static"
    )

    # Catch-all route to serve index.html for client-side routing
    # This must be one of the last routes registered
    @app.get("/{full_path:path}", include_in_schema=False)
    async def serve_react_app(full_path: str):
        index_path = os.path.join(BUILD_DIR, "index.html")
        if not os.path.exists(index_path):
            raise HTTPException(status_code=404, detail="React app index.html not found")
        return FileResponse(index_path)

    # Note: Ensure your API routers are included before this catch-all.
    # For example:
    # from app.api.v1 import api_router
    # app.include_router(api_router, prefix="/api") 
    ```
    For more details, refer to the [FastAPI Static Files documentation](https://fastapi.tiangolo.com/tutorial/static-files/).

## API Base URL Configuration

The React application is configured to make API calls to relative paths (e.g., `/api/auth/login`). This setup works seamlessly if the frontend and backend are served from the **same domain and port**.

*   **Same-Domain Deployment:** If you deploy the frontend (e.g., `frontend/build`) and the Python backend on the same server and domain (e.g., `yourdomain.com/` serves React, and `yourdomain.com/api/` serves FastAPI), no changes are typically needed for API calls.

*   **Different Domains (Cross-Origin):**
    If the frontend is served from a different domain/port than the backend (e.g., frontend on `https://app.yourdomain.com`, backend on `https://api.yourdomain.com`), you will need to:
    1.  **Configure CORS (Cross-Origin Resource Sharing) on the FastAPI backend:** Allow requests from your frontend's domain. See [FastAPI CORS documentation](https://fastapi.tiangolo.com/tutorial/cors/).
    2.  **Set the API Base URL in Frontend:** The `axios` calls in the React app (or a global `axios` instance) would need to be configured to use the absolute API URL (e.g., `https://api.yourdomain.com/api/`). This can be managed through:
        *   **Environment Variables at Build Time:** `create-react-app` supports environment variables prefixed with `REACT_APP_`. You could define `REACT_APP_API_BASE_URL` and use it in your app.
            ```javascript
            // Example usage in a component or axios setup
            const API_URL = process.env.REACT_APP_API_BASE_URL || '/api';
            axios.post(`${API_URL}/auth/login`, ...);
            ```
            You would set this variable when building the app: `REACT_APP_API_BASE_URL="https://api.yourdomain.com/api" npm run build`.
        *   **Runtime Configuration:** Include a `config.js` file in the `public` folder and load it at runtime.

For this project, the simplest approach is to serve both frontend and backend from the same domain, or ensure the backend's CORS policy allows requests from the frontend's deployment domain. The current setup assumes relative API paths.
```
